{"ast":null,"code":"import { useEffect, useState, useRef, useCallback } from \"react\";\nimport { fetchMenu } from \"../../store/actions/menuAction\";\nimport { useStore } from \"../../store\";\n\nconst useSticky = () => {\n  const {\n    0: isSticky,\n    1: setSticky\n  } = useState(false);\n  const {\n    0: hideNav,\n    1: setHideNav\n  } = useState(false);\n  const element = useRef(null);\n  const store = useStore();\n\n  if (false) {\n    var prevScrollpos = window.pageYOffset;\n  }\n\n  const handleScroll = () => {\n    var currentScrollPos = window.pageYOffset;\n\n    if (element.current) {\n      if (parseInt(currentScrollPos) <= 0) {\n        setHideNav(false);\n        setSticky(false);\n        return;\n      } else {\n        if (currentScrollPos <= prevScrollpos) {\n          setHideNav(false);\n          setSticky(false);\n        } else {\n          setHideNav(true);\n          setSticky(true);\n          store.dispatch(fetchMenu);\n        }\n      }\n\n      prevScrollpos = currentScrollPos;\n    }\n  }; // This function handle the scroll performance issue\n\n\n  function debounce(func, wait = 20, immediate = true) {\n    let timeOut;\n    return () => {\n      let context = this,\n          args = arguments;\n\n      const later = () => {\n        timeOut = null;\n        if (!immediate) func.apply(context, args);\n      };\n\n      const callNow = immediate && !timeOut;\n      clearTimeout(timeOut);\n      timeOut = setTimeout(later, wait);\n      if (callNow) func.apply(context, args);\n    };\n  }\n\n  const scrollHandler = useCallback(() => {\n    debounce(handleScroll());\n  }, []);\n  useEffect(() => {\n    window.addEventListener(\"scroll\", scrollHandler);\n    return () => {\n      window.removeEventListener(\"scroll\", scrollHandler);\n    };\n  }, [debounce, handleScroll]);\n  return {\n    isSticky,\n    element,\n    hideNav\n  };\n};\n\nexport default useSticky;","map":{"version":3,"sources":["/Users/sosokorn/Documents/Project/ten11-web-reactjs-nextjs/shared/hooks/useSticky.js"],"names":["useEffect","useState","useRef","useCallback","fetchMenu","useStore","useSticky","isSticky","setSticky","hideNav","setHideNav","element","store","prevScrollpos","window","pageYOffset","handleScroll","currentScrollPos","current","parseInt","dispatch","debounce","func","wait","immediate","timeOut","context","args","arguments","later","apply","callNow","clearTimeout","setTimeout","scrollHandler","addEventListener","removeEventListener"],"mappings":"AAAA,SAASA,SAAT,EAAoBC,QAApB,EAA8BC,MAA9B,EAAsCC,WAAtC,QAAyD,OAAzD;AACA,SAASC,SAAT,QAA0B,gCAA1B;AACA,SAASC,QAAT,QAAyB,aAAzB;;AACA,MAAMC,SAAS,GAAG,MAAM;AACtB,QAAM;AAAA,OAACC,QAAD;AAAA,OAAWC;AAAX,MAAwBP,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAM;AAAA,OAACQ,OAAD;AAAA,OAAUC;AAAV,MAAwBT,QAAQ,CAAC,KAAD,CAAtC;AACA,QAAMU,OAAO,GAAGT,MAAM,CAAC,IAAD,CAAtB;AACA,QAAMU,KAAK,GAAGP,QAAQ,EAAtB;;AAEA,aAAmC;AACjC,QAAIQ,aAAa,GAAGC,MAAM,CAACC,WAA3B;AACD;;AAED,QAAMC,YAAY,GAAG,MAAM;AACzB,QAAIC,gBAAgB,GAAGH,MAAM,CAACC,WAA9B;;AACA,QAAIJ,OAAO,CAACO,OAAZ,EAAqB;AACnB,UAAIC,QAAQ,CAACF,gBAAD,CAAR,IAA8B,CAAlC,EAAqC;AACnCP,QAAAA,UAAU,CAAC,KAAD,CAAV;AACAF,QAAAA,SAAS,CAAC,KAAD,CAAT;AACA;AACD,OAJD,MAIO;AACL,YAAIS,gBAAgB,IAAIJ,aAAxB,EAAuC;AACrCH,UAAAA,UAAU,CAAC,KAAD,CAAV;AACAF,UAAAA,SAAS,CAAC,KAAD,CAAT;AACD,SAHD,MAGO;AACLE,UAAAA,UAAU,CAAC,IAAD,CAAV;AACAF,UAAAA,SAAS,CAAC,IAAD,CAAT;AACAI,UAAAA,KAAK,CAACQ,QAAN,CAAehB,SAAf;AACD;AACF;;AAEDS,MAAAA,aAAa,GAAGI,gBAAhB;AACD;AACF,GApBD,CAVsB,CAgCtB;;;AACA,WAASI,QAAT,CAAkBC,IAAlB,EAAwBC,IAAI,GAAG,EAA/B,EAAmCC,SAAS,GAAG,IAA/C,EAAqD;AACnD,QAAIC,OAAJ;AACA,WAAO,MAAM;AACX,UAAIC,OAAO,GAAG,IAAd;AAAA,UACEC,IAAI,GAAGC,SADT;;AAEA,YAAMC,KAAK,GAAG,MAAM;AAClBJ,QAAAA,OAAO,GAAG,IAAV;AACA,YAAI,CAACD,SAAL,EAAgBF,IAAI,CAACQ,KAAL,CAAWJ,OAAX,EAAoBC,IAApB;AACjB,OAHD;;AAIA,YAAMI,OAAO,GAAGP,SAAS,IAAI,CAACC,OAA9B;AACAO,MAAAA,YAAY,CAACP,OAAD,CAAZ;AACAA,MAAAA,OAAO,GAAGQ,UAAU,CAACJ,KAAD,EAAQN,IAAR,CAApB;AACA,UAAIQ,OAAJ,EAAaT,IAAI,CAACQ,KAAL,CAAWJ,OAAX,EAAoBC,IAApB;AACd,KAXD;AAYD;;AAED,QAAMO,aAAa,GAAG/B,WAAW,CAAC,MAAM;AACtCkB,IAAAA,QAAQ,CAACL,YAAY,EAAb,CAAR;AACD,GAFgC,EAE9B,EAF8B,CAAjC;AAIAhB,EAAAA,SAAS,CAAC,MAAM;AACdc,IAAAA,MAAM,CAACqB,gBAAP,CAAwB,QAAxB,EAAkCD,aAAlC;AACA,WAAO,MAAM;AACXpB,MAAAA,MAAM,CAACsB,mBAAP,CAA2B,QAA3B,EAAqCF,aAArC;AACD,KAFD;AAGD,GALQ,EAKN,CAACb,QAAD,EAAWL,YAAX,CALM,CAAT;AAOA,SAAO;AAAET,IAAAA,QAAF;AAAYI,IAAAA,OAAZ;AAAqBF,IAAAA;AAArB,GAAP;AACD,CA7DD;;AA8DA,eAAeH,SAAf","sourcesContent":["import { useEffect, useState, useRef, useCallback } from \"react\";\nimport { fetchMenu } from \"../../store/actions/menuAction\";\nimport { useStore } from \"../../store\";\nconst useSticky = () => {\n  const [isSticky, setSticky] = useState(false);\n  const [hideNav, setHideNav] = useState(false);\n  const element = useRef(null);\n  const store = useStore();\n\n  if (typeof window !== \"undefined\") {\n    var prevScrollpos = window.pageYOffset;\n  }\n\n  const handleScroll = () => {\n    var currentScrollPos = window.pageYOffset;\n    if (element.current) {\n      if (parseInt(currentScrollPos) <= 0) {\n        setHideNav(false);\n        setSticky(false);\n        return;\n      } else {\n        if (currentScrollPos <= prevScrollpos) {\n          setHideNav(false);\n          setSticky(false);\n        } else {\n          setHideNav(true);\n          setSticky(true);\n          store.dispatch(fetchMenu);\n        }\n      }\n\n      prevScrollpos = currentScrollPos;\n    }\n  };\n\n  // This function handle the scroll performance issue\n  function debounce(func, wait = 20, immediate = true) {\n    let timeOut;\n    return () => {\n      let context = this,\n        args = arguments;\n      const later = () => {\n        timeOut = null;\n        if (!immediate) func.apply(context, args);\n      };\n      const callNow = immediate && !timeOut;\n      clearTimeout(timeOut);\n      timeOut = setTimeout(later, wait);\n      if (callNow) func.apply(context, args);\n    };\n  }\n\n  const scrollHandler = useCallback(() => {\n    debounce(handleScroll());\n  }, []);\n\n  useEffect(() => {\n    window.addEventListener(\"scroll\", scrollHandler);\n    return () => {\n      window.removeEventListener(\"scroll\", scrollHandler);\n    };\n  }, [debounce, handleScroll]);\n\n  return { isSticky, element, hideNav };\n};\nexport default useSticky;\n"]},"metadata":{},"sourceType":"module"}