{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\n\nvar _this = this,\n    _jsxFileName = \"/Users/sosokorn/Documents/Project/ten11-web-reactjs-nextjs/pages/product/[slug].js\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\nimport React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { wrapper, State } from \"../../store/store\";\nimport { useRouter } from \"next/router\";\nimport cookieCutter from \"cookie-cutter\";\nimport \"../productList.css\";\nimport Layout from \"../../components/layouts/Layout\";\nimport Container from \"../../components/Containers/Container\";\nimport \"antd/dist/antd.css\";\nimport ProductItem from \"../../components/Products/ProductItem\";\nimport useSticky from \"../../shared/hooks/useSticky\";\nimport ProductListLoading from \"../../components/Loading/ProductListLoading\";\nimport ListSideBarMenu from \"../../components/Products/ListSideBarMenu\";\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport { FiRefreshCw } from \"react-icons/fi\";\n\nvar ProductList = function ProductList(props) {\n  _s();\n\n  console.log(props.product);\n  var router = useRouter(); // const { page, id, slug } = router.query;\n\n  var page = router.query.page || 1;\n  var hideNav = useSticky.hideNav;\n\n  var _useState = useState(true),\n      hasMore = _useState[0],\n      setHasMore = _useState[1];\n\n  var _useState2 = useState([]),\n      listProduct = _useState2[0],\n      setListProduct = _useState2[1];\n\n  useEffect(function () {\n    debugger;\n\n    if (props.product !== undefined && props.product.list !== undefined) {\n      if (Number(page) === 1) {\n        setListProduct(props.product.list);\n        localStorage.setItem(\"totalproduct\", props.product.total_record);\n      } else if (Number(page) > 1) {\n        setListProduct([].concat(_toConsumableArray(listProduct), _toConsumableArray(props.product.list)));\n      }\n    }\n  }, [props.product]);\n\n  function onChange(e) {\n    console.log(\"checked = \".concat(e.target.checked));\n  }\n\n  var loadItems = function loadItems() {\n    var category_seo = cookieCutter.get(\"category_seo\");\n    var totalProduct = localStorage.getItem(\"totalproduct\");\n    if (listProduct.length > 0) if (listProduct.length < Number(totalProduct)) {\n      setHasMore(true);\n      router.push({\n        pathname: \"/product/\".concat(category_seo),\n        query: {\n          page: \"\".concat(Number(page) + 1)\n        },\n        as: \"/product/\".concat(category_seo)\n      });\n    } else {\n      setHasMore(false);\n    }\n  };\n\n  var refresh = function refresh() {};\n\n  var loader = __jsx(\"div\", {\n    className: \"load-more\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62,\n      columnNumber: 5\n    }\n  }, __jsx(\"div\", {\n    className: \"load-more-block\",\n    onClick: props.onClick,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 7\n    }\n  }, __jsx(FiRefreshCw, {\n    className: \"\".concat(hasMore ? \"load-more-icon\" : \"no-load-more\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 9\n    }\n  }), __jsx(\"span\", {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67,\n      columnNumber: 9\n    }\n  }, \"Load more...\"))); // if (props.isLoading) return <ProductListLoading />;\n  // if (router.isFallback) {\n  //   return <ProductListLoading />;\n  // }\n\n\n  return __jsx(React.Fragment, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 5\n    }\n  }, __jsx(Layout, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }\n  }, __jsx(Container, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 9\n    }\n  }, __jsx(\"div\", {\n    className: \"row\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 11\n    }\n  }, __jsx(ListSideBarMenu // mainCategory={slug[0]}\n  // paramsId={paramsId}\n  // category_name={slug[0]}\n  , {\n    hideNav: hideNav,\n    onChange: onChange,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 13\n    }\n  }), __jsx(\"div\", {\n    className: \"main\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 13\n    }\n  }, __jsx(InfiniteScroll, {\n    className: \"rowChild\",\n    dataLength: listProduct.length || 0,\n    next: loadItems,\n    hasMore: hasMore,\n    loader: loader,\n    refreshFunction: refresh,\n    pullDownToRefresh: true,\n    pullDownToRefreshThreshold: 50,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 15\n    }\n  }, listProduct.map(function (item, index) {\n    return __jsx(ProductItem, _extends({\n      key: index\n    }, item, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100,\n        columnNumber: 19\n      }\n    }));\n  })))))));\n};\n\n_s(ProductList, \"GNP6WLki5/3avUxshQaeDnaiUgo=\", false, function () {\n  return [useRouter];\n});\n\n_c = ProductList;\nexport var __N_SSP = true;\nexport default ProductList;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductList\");","map":{"version":3,"sources":["/Users/sosokorn/Documents/Project/ten11-web-reactjs-nextjs/pages/product/[slug].js"],"names":["React","useEffect","useState","connect","wrapper","State","useRouter","cookieCutter","Layout","Container","ProductItem","useSticky","ProductListLoading","ListSideBarMenu","InfiniteScroll","FiRefreshCw","ProductList","props","console","log","product","router","page","query","hideNav","hasMore","setHasMore","listProduct","setListProduct","undefined","list","Number","localStorage","setItem","total_record","onChange","e","target","checked","loadItems","category_seo","get","totalProduct","getItem","length","push","pathname","as","refresh","loader","onClick","map","item","index"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\nimport { connect } from \"react-redux\";\nimport { wrapper, State } from \"../../store/store\";\nimport { useRouter } from \"next/router\";\nimport cookieCutter from \"cookie-cutter\";\nimport \"../productList.css\";\nimport Cookies from \"cookies\";\nimport Layout from \"../../components/layouts/Layout\";\nimport Container from \"../../components/Containers/Container\";\nimport \"antd/dist/antd.css\";\nimport ProductItem from \"../../components/Products/ProductItem\";\nimport useSticky from \"../../shared/hooks/useSticky\";\nimport ProductListLoading from \"../../components/Loading/ProductListLoading\";\nimport ListSideBarMenu from \"../../components/Products/ListSideBarMenu\";\nimport InfiniteScroll from \"react-infinite-scroll-component\";\nimport { FiRefreshCw } from \"react-icons/fi\";\nimport { serviceApiFormData } from \"../../shared/hooks/seviceApi\";\n\nconst ProductList = (props) => {\n  console.log(props.product);\n  const router = useRouter();\n  // const { page, id, slug } = router.query;\n  const page = router.query.page || 1\n  const { hideNav } = useSticky;\n  const [hasMore, setHasMore] = useState(true);\n  const [listProduct, setListProduct] = useState([]);\n\n  useEffect(() => {\n    debugger\n    if (props.product !== undefined && props.product.list !== undefined) {\n      if (Number(page) === 1) {\n        setListProduct(props.product.list);\n        localStorage.setItem(\"totalproduct\", props.product.total_record);\n      } else if (Number(page) > 1) {\n        setListProduct([...listProduct, ...props.product.list]);\n      }\n    }\n  }, [props.product]);\n\n  function onChange(e) {\n    console.log(`checked = ${e.target.checked}`);\n  }\n\n  const loadItems = () => {\n    const category_seo = cookieCutter.get(\"category_seo\");\n    const totalProduct = localStorage.getItem(\"totalproduct\");\n    if (listProduct.length > 0)\n      if (listProduct.length < Number(totalProduct)) {\n        setHasMore(true);\n        router.push({\n          pathname: `/product/${category_seo}`,\n          query: { page: `${Number(page) + 1}` },\n          as: `/product/${category_seo}`,\n        });\n      } else {\n        setHasMore(false);\n      }\n  };\n\n  const refresh = () => {};\n  const loader = (\n    <div className=\"load-more\">\n      <div className=\"load-more-block\" onClick={props.onClick}>\n        <FiRefreshCw\n          className={`${hasMore ? \"load-more-icon\" : \"no-load-more\"}`}\n        />\n        <span>Load more...</span>\n      </div>\n    </div>\n  );\n\n  // if (props.isLoading) return <ProductListLoading />;\n  // if (router.isFallback) {\n  //   return <ProductListLoading />;\n  // }\n  return (\n    <React.Fragment>\n      <Layout>\n        <Container>\n          <div className=\"row\">\n            <ListSideBarMenu\n              // mainCategory={slug[0]}\n              // paramsId={paramsId}\n              // category_name={slug[0]}\n              hideNav={hideNav}\n              onChange={onChange}\n            />\n            <div className=\"main\">\n              <InfiniteScroll\n                className=\"rowChild\"\n                dataLength={listProduct.length || 0}\n                next={loadItems}\n                hasMore={hasMore}\n                loader={loader}\n                refreshFunction={refresh}\n                pullDownToRefresh\n                pullDownToRefreshThreshold={50}\n              >\n                {listProduct.map((item, index) => (\n                  <ProductItem key={index} {...item} />\n                ))}\n              </InfiniteScroll>\n            </div>\n          </div>\n        </Container>\n      </Layout>\n    </React.Fragment>\n  );\n};\n\nexport const getServerSideProps = async (context) => {\n  const page = context.query.page || \"1\";\n  try {\n    const api = serviceApiFormData();\n    const cookies = new Cookies(context.req, context.res);\n    const category_seo = cookies.get(\"category_seo\");\n\n    const data = {\n      page: page,\n      seo_url: category_seo,\n    };\n    console.log(data);\n    const productList = await api.post(\"ListProductWeb/getProductList\", data);\n    const product = productList.data;\n    return {\n      props: {\n        product,\n      },\n    };\n  } catch {\n    return {\n      props: {\n        product: {},\n      },\n    };\n  }\n};\n\nexport default ProductList;\n"]},"metadata":{},"sourceType":"module"}